# 最小工时

---

给定各工序的时间和先序工序，利用PT图和关键路径的方法，求出完成所有工序的最少时间及各个工序允许延误的时间。

保证给出的先序工序中不存在环依赖。

#### 输入

第 $1$ 行工序的个数 $n$ $(1 \leq n \leq 100)$ 。

第 $2$ 到第 $n + 1$ 行包含空格隔开的工序号 $V(i)$ 、所需时间 $t$ 、$V(i)$ 的先序工序的个数 $s(i)$ 并紧跟着 $s(i)$ 个先序工序 $V_{pre}(k)(k = 1 .. s(i), 0 \leq V(i) < n, 0 \leq V_{pre}(k) < V(i))$ 。若无先序工序，则 $s(i)= 0$ 。保证工序号为 $i$ 的工序的所有前序工序标号均小于 $i$ 。

注：工序号 $V(i)$ 从第 2 行起，必定是顺序的从 0 到 $n - 1$ ；可能有多个工序的先序工序为空。

输入和结果均不会超过 `int` 的范围。


#### 输出

输出文件共n+1行：

第1行，求出完成所有工序所需要的最少时间。

第2~n+1行，输出在以最少时间完成工序时，各工序最大允许延误时间。

#### 输入样例1

```
5
0 1 0
1 3 1 0
2 1 1 0
3 5 2 0 1
4 2 2 0 2
```

#### 输出样例1

```
9
0
0
5
0
5
```

#### 输入样例2

```
20
0 10 0
1 2 0
2 9 2 0 1
3 10 1 2
4 3 0
5 6 0
6 1 0
7 7 0
8 2 2 0 7
9 4 3 1 3 6
10 5 3 1 5 8
11 1 3 5 6 9
12 3 1 6
13 3 0
14 7 6 2 6 9 10 12 13
15 10 2 3 7
16 3 3 0 13 15
17 7 1 3
18 5 2 0 14
19 3 5 1 9 10 14 17
```

#### 输出样例2

```
45
0
8
0
0
42
22
28
19
16
0
16
11
29
30
0
3
3
6
0
2
```

提示： 由于保证工序号为i𝑖的工序的所有前序工序标号均小于$i$，因此$123..n$是一个天然拓扑序。